<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>會員留言區</title>
    <link rel="icon" href="images/travel.png">
    <link rel="stylesheet" href="nicepage.css" media="screen">
    <link rel="stylesheet" href="Comment-Rating.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <meta name="generator" content="Nicepage 4.0.3, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    <link rel="stylesheet" type="text/css" href="star-main.css">
    <link rel="stylesheet" href="statics/css/font-awesome.min.css">
    <link rel="stylesheet" href="star-main.css" media="all" type="text/css"/>
    <script src="statics/js/jquery-3.4.1.min.js"></script>

    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": ""
	}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Comment Rating">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body">
    <section class="u-clearfix u-grey-10 u-section-1" id="carousel_da80">
    <header class="u-clearfix u-header" id="sec-320d" data-animation-name="" data-animation-duration="0" data-animation-delay="0" data-animation-direction=""><div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-border-1 u-border-custom-color-2 u-line u-line-vertical u-line-1"></div>
        <img class="u-image u-image-default u-preserve-proportions u-image-1" src="images/logo2.png" alt="" data-image-width="180" data-image-height="70" data-href="Home.html" data-page-id="34435806">
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="text-transform: uppercase; font-size: 0.75rem; letter-spacing: 2px; font-weight: 700;">
            <a class="u-btn-text u-button-style u-custom-color u-custom-text-color u-nav-link u-text-body-alt-color" href="#" style="padding: 4px 24px; font-size: calc(1em + 8px);">
              <svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 302 302" style="undefined"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-a760"></use></svg>
              <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="svg-a760" x="0px" y="0px" viewBox="0 0 302 302" style="enable-background:new 0 0 302 302;" xml:space="preserve" class="u-svg-content"><g><rect y="36" width="302" height="30"></rect><rect y="236" width="302" height="30"></rect><rect y="136" width="302" height="30"></rect>
              </g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-palette-3-base u-text-palette-1-dark-2" href="Home.html">Home</a>
              </li><li class="u-nav-item"><a class="u-button-style u-nav-link u-palette-3-base u-text-palette-1-dark-2" href="#">Visitor</a>
              </li><li class="u-nav-item"><a class="u-button-style u-nav-link u-palette-3-base u-text-palette-1-dark-2" href="MemSearch.html">Member</a>
              </li><li class="u-nav-item"><a class="u-button-style u-nav-link u-palette-3-base u-text-palette-1-dark-2" href="MemSearch.html">Search</a>
              </li></ul>&emsp;&emsp;&emsp;
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Home.html">Home</a>
                  </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="#">Visitor</a>
                  </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Update.html">Member</a>
                  </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="MemSearch.html">Search</a>
                  </li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
        <a onclick=logout() class="u-border-1 u-border-active-palette-2-base u-border-hover-palette-1-base u-btn u-button-style u-none u-text-custom-color-2 u-btn-2">LogOut</a>
      </div></header>
    <section class="u-clearfix u-grey-10 u-section-1" id="carousel_da80">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-size-18-lg u-size-18-xl u-size-29-sm u-size-29-xs u-size-60-md">
                <div class="u-layout-col">
                  <div class="u-align-center-sm u-align-center-xs u-container-style u-layout-cell u-palette-5-light-1 u-size-60 u-layout-cell-1">
                    <div class="u-container-layout u-container-layout-1">
                      <br>
                      <span style="font-size: 30px" id="starStr">你的評論</span><br><br>
                      <div class="panel-body" style="text-align: center">
           		  	  	  <input name="starNum" id="starNum" type="hidden"/>
                          <div class="starability-container" style="margin-left:29%">
           	                <fieldset class="starability-slot">
           		                 <input type="radio" id="rate_1_0_1_5" name="starLevel" value=5 />
           		                  <label for="rate_1_0_1_5" title="5星"></label>
           		                  <input type="radio" id="rate_1_0_1_4" name="starLevel" value=4 />
           		                  <label for="rate_1_0_1_4" title="4星"></label>
           		                  <input type="radio" id="rate_1_0_1_3" name="starLevel" value=3 />
           		                  <label for="rate_1_0_1_3" title="3星"></label>
           		                  <input type="radio" id="rate_1_0_1_2" name="starLevel" value=2 />
           		                  <label for="rate_1_0_1_2" title="2星"></label>
           		                  <input type="radio" id="rate_1_0_1_1" name="starLevel" value=1 />
           		                  <label for="rate_1_0_1_1" title="1星"></label>
           	                 </fieldset>
                          </div>
                                <div class="beizu" style="text-align: center;margin-left:0%;margin-right:15%">
                         			   	<textarea class="beizu-text" id="user_comment"
                         			   		name="user_comment"
                         			   		placeholder="請輸入評論"
                         	        	class="form-control" rows="5" style="margin: 30px; width: 100%;"></textarea>
                             	  </div>

                                <!--按钮-->
                                <div class="anniu" >
                                    <input type='button' id='submit' value='留言' style = "margin-bottom: 0.8rem !important;" onclick='myfunc();'  class="btn btn-primary btn-lg btn-block" />
                                    <input type='button' id='close' value='返回' style = "margin-bottom: 0.8rem !important;" onclick='closed();'  class="btn btn-default btn-lg btn-block" />
                                	<input type='button' id='check' value='查看您的留言' style = "margin-bottom: 0.8rem !important;" onclick='check();'  class="btn btn-default btn-lg btn-block" />
                                </div>

                                <div class="evalDe1"></div>
                                <div class="evalDe2"></div>
                                
                                <!-- 顯示評論區 -->
                                <div class="u-size-31-sm u-size-31-xs u-size-42-lg u-size-42-xl u-size-60-md">
                                  <div class="u-layout-col">
                                    <div class="u-size-60">
                                      <div class="u-layout-row">
                                        <div class="u-align-center-sm u-align-center-xs u-container-style u-grey-15 u-layout-cell u-size-60 u-layout-cell-2">
                                          <div class="u-container-layout u-container-layout-2">
                                            <table border="2px">
                                              <tr>
                                                <th style="width: 70%;">會員帳號</th>
                                                <th style="width: 70%;">大家的想法</th>
                                                <th style="width: 30%;">評分</th>
                                              </tr>
                                              <tbody id="showComment">
                                              
                                              </tbody>
                                            </table>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>

	<script type="text/javascript">
	$(document).ready(function () {
		
        
		$.ajax({
			headers: { 
                'Accept': 'application/json',
                'Content-Type': 'application/json' 
            },
            type: "GET",
            dataType: 'json',
            url: "api/CommentRatingController.do",
            success:function(response){
            	console.log(response.response.data);
            	var html = "";
            	for(var a = 0; a < response.response.data.length; a++){
            		var userEmail = response.response.data[a].user_email;
            		var userCom = response.response.data[a].user_comment;
            		var userRate = response.response.data[a].user_rating;
            		
            		html += "<tr>";
            		html += "<td>" + userEmail + "</td>";
            		html += "<td>" + userCom + "</td>";
            		html += "<td>" + userRate + "</td";
            		html += "</tr>";
            	}
            	document.getElementById("showComment").innerHTML = html;
            }
		})
	});
	function getCookie(cname,cvalue){
    	var name = cname + "=";
        var ca = document.cookie.split(';');
        for(var i=0; i<ca.length; i++) 
        {
          var c = ca[i].trim();
          if (c.indexOf(name)==0) return c.substring(name.length,c.length);
        }
        return "";
    };
    
	
		function myfunc(uEmail){
			var uEmail = getCookie("email");
	        var uComment=$("#user_comment").val();
	        var uRating = $("input[name='starLevel']:checked").val();
	        
	        if (uComment.length > 100) {
	            alert("留言太長了");
	        }else{
	        var data_object={
	        		"user_email":uEmail,
	                "user_comment":uComment,
	                "user_rating":uRating,
	        };
	        if (uComment==""){
	        	alert("還沒留下留言喔");
	        }else if(uRating == ""){
	        	alert("還沒留下評分喔");
	        }
	        else{
	          $.ajax({
	            headers: { 
	                'Accept': 'application/json',
	                'Content-Type': 'application/json' 
	            },
	            type: "POST",
	            dataType: 'json',
	            url: "api/CommentRatingController.do",
	            data: JSON.stringify(data_object),
	            success:function(response){
	          		alert(response.message);
	          		window.location.href = "Comment-Rating-mem.html";
	            },
	            error:function(){
	              alert("無法連線到伺服器");
	            }
	        });
	      	}
	       }
	}
		function closed(){
			window.location.href = "MemSearch.html";
		}	
	     function check(){
	    	 window.location.href = "DeleteComment.html";
	     }
	     function setCookie(cname,cvalue){
 			document.cookie = cname + "=" + cvalue;
 		};
	     function logout(){
	            var check = window.confirm("確認登出？");
	               if (check == true) {
	            		setCookie("id","");
	            		setCookie("email","");
	                	location.href = 'Home.html';
	               }else{
	            	   alert("您不要登出了嗎？");
	               }
	     }
          </script> 
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </body>
</html>
